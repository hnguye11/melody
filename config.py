import os
import numpy as np

DEVNULL = open(os.devnull, 'wb')

BUS_VM = {1: 1.039383641870841, 2: 1.048494112676652, 3: 1.030707706725096, 4: 1.004459967220413, 5: 1.006006257395997, 6: 1.008225577917792, 7: 0.9983972834790765, 8: 0.9978723157653281, 9: 1.038331965091507, 10: 1.017843130480193, 11: 1.013385780267502, 12: 1.000815032093443, 13: 1.014922962785832, 14: 1.01231896150092, 15: 1.016185364676623, 16: 1.032520258766773, 17: 1.034236506405595, 18: 1.031572600769791, 19: 1.050106758160188, 20: 0.9910105434913988, 21: 1.032319181777661, 22: 1.050142736601146, 23: 1.045145075176333, 24: 1.038001009801555, 25: 1.057682747991018, 26: 1.052561292566947, 27: 1.038344911861136, 28: 1.0503736565441, 29: 1.050114902048033, 30: 1.0499, 31: 0.982, 32: 0.9841, 33: 0.9972, 34: 1.0123, 35: 1.0494, 36: 1.0636, 37: 1.0275, 38: 1.0265, 39: 1.03}

LOAD_PQ = {1: (97.6, 44.2), 2: (0.0, 0.0), 3: (322.0, 2.4), 4: (500.0, 184.0), 5: (0.0, 0.0), 6: (0.0, 0.0), 7: (233.8, 84.0), 8: (522.0, 176.6), 9: (6.5, -66.6), 10: (0.0, 0.0), 11: (0.0, 0.0), 12: (8.53, 88.0), 13: (0.0, 0.0), 14: (0.0, 0.0), 15: (320.0, 153.0), 16: (329.0, 32.3), 17: (0.0, 0.0), 18: (158.0, 30.0), 19: (0.0, 0.0), 20: (680.0, 103.0), 21: (274.0, 115.0), 22: (0.0, 0.0), 23: (247.5, 84.6), 24: (308.6, -92.2), 25: (224.0, 47.2), 26: (139.0, 17.0), 27: (281.0, 75.5), 28: (206.0, 27.6), 29: (283.5, 26.9), 30: (0.0, 0.0), 31: (9.2, 4.6), 32: (0.0, 0.0), 33: (0.0, 0.0), 34: (0.0, 0.0), 35: (0.0, 0.0), 36: (0.0, 0.0), 37: (0.0, 0.0), 38: (0.0, 0.0), 39: (1104.0, 250.0)}

GEN_PQ = {32: (206.9648550666588, 300.0), 33: (108.2927865573144, 250.0), 34: (166.6883696651357, 167.0), 35: (210.6613838960686, 300.0), 36: (100.1647923841189, 240.0), 37: (-1.369447391595866, 250.0), 38: (21.73272896306111, 300.0), 39: (78.46735923299312, 300.0), 30: (161.7616482290049, 400.0), 31: (221.5744864162004, 300.0)}

GEN = sorted(GEN_PQ.keys())
GEN_NO = len(GEN)
LOAD = sorted(LOAD_PQ.keys())
LOAD_NO = len(LOAD)

PILOT_BUS = [2, 6, 9, 10, 19, 20, 22, 23, 25, 29]

SLEEP_TIME = 2
BUSY_WAITING_TIME = 0.05

# For asynchronous buffer communication
GEN_BUS_V = "GEN_BUS_%d_V"
PILOT_BUS_V = "PILOT_BUS_%d_V"
LOAD_BUS_Q = "LOAD_BUS_%d_Q"

# For plotting
PLOT_GEN_BUS_V = "PLOT_GEN_BUS_V"
PLOT_PILOT_BUS_V = "PLOT_PILOT_BUS_V"
PLOT_LOAD_BUS_Q = "PLOT_LOAD_BUS_Q"

PROXY_ID = 1000
DISTURBANCE_ID = 1001
CONTROLLER_ID = 1002

CONTROLLER_IP_ADDR = "127.0.0.1"
PLC_IP_ADDR = "127.0.0.1"
PILOT_BUS_V_PORT = 5555
GEN_BUS_V_PORT = 5556

# For synchronous buffer communication
GEN_BUS_V_BUFFER = {30:"PSS_BUFFER_000", 31:"PSS_BUFFER_001", 32:"PSS_BUFFER_002", 33:"PSS_BUFFER_003", 34:"PSS_BUFFER_004", 35:"PSS_BUFFER_005", 36:"PSS_BUFFER_006", 37:"PSS_BUFFER_007", 38:"PSS_BUFFER_008", 39:"PSS_BUFFER_009"}

PILOT_BUS_V_BUFFER = {2:"PSS_BUFFER_010", 6:"PSS_BUFFER_011", 9:"PSS_BUFFER_012", 10:"PSS_BUFFER_013", 19:"PSS_BUFFER_014", 20:"PSS_BUFFER_015", 22:"PSS_BUFFER_016", 23:"PSS_BUFFER_017", 25:"PSS_BUFFER_018", 29:"PSS_BUFFER_019"}

LOAD_BUS_Q_BUFFER = {1:"PSS_BUFFER_020", 2:"PSS_BUFFER_021", 3:"PSS_BUFFER_022", 4:"PSS_BUFFER_023", 5:"PSS_BUFFER_024", 6:"PSS_BUFFER_025", 7:"PSS_BUFFER_026", 8:"PSS_BUFFER_027", 9:"PSS_BUFFER_028", 10:"PSS_BUFFER_029", 11:"PSS_BUFFER_030", 12:"PSS_BUFFER_031", 13:"PSS_BUFFER_032", 14:"PSS_BUFFER_033", 15:"PSS_BUFFER_034", 16:"PSS_BUFFER_035", 17:"PSS_BUFFER_036", 18:"PSS_BUFFER_037", 19:"PSS_BUFFER_038", 20:"PSS_BUFFER_039", 21:"PSS_BUFFER_040", 22:"PSS_BUFFER_041", 23:"PSS_BUFFER_042", 24:"PSS_BUFFER_043", 25:"PSS_BUFFER_044", 26:"PSS_BUFFER_045", 27:"PSS_BUFFER_046", 28:"PSS_BUFFER_047", 29:"PSS_BUFFER_048", 30:"PSS_BUFFER_049", 31:"PSS_BUFFER_050", 32:"PSS_BUFFER_051", 33:"PSS_BUFFER_052", 34:"PSS_BUFFER_053", 35:"PSS_BUFFER_054", 36:"PSS_BUFFER_055", 37:"PSS_BUFFER_056", 38:"PSS_BUFFER_057", 39:"PSS_BUFFER_058"}
